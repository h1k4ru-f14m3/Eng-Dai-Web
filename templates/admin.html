{% extends "base.html" %}

{% block title %}Admin{% endblock %}

{% block main %}
<h1 style="text-align: center;">English to Dai</h1>

<form action="/update" method="post">
    <div class="adminBar">
        <input type="text" name="q" autofocus autocomplete=off placeholder="Search" class="searchbar" id="admin_search">
        <button type="button" class="button">Apply Changes</button>
        <button type="button" class="button">Add</button>
    </div>
    <div class="admin list" id="admin_list">
    {% for row in data %}
        <div class="item">
            <a class="admininput eng" data-id="{{ row [0] }}" data-eng="{{ row[1] }}" data-dai="{{ row[2] }}">{{ row[1] }}</a>
            <p class="dai">{{ row[2] }}</p>
        </div>
    {% endfor %}
    </div>
</form>

<div class="changes list">
    <p>No Changes.</p>
</div>

<div class="modal">
    <div class="popup">
        <h1>Edit Panel</h1>

        <label for="id">Word-ID:</label>
        <input class="id-input" disabled name="id">

        <label for="eng">English:</label>
        <input class="eng-input" name="eng">

        <label for="dai">Dai:</label>
        <input class="dai-input" name="dai">

        <div class="buttons">
            <button class="button" id="submit">Submit</button>
            <button class="button" id="cancel">Cancel</button>
        </div>
    </div>
</div>

<script type="module">
    import { search } from "{{ url_for('static', filename='functions.js') }}";
    
    let admin_input = document.querySelector("#admin_search");
    search(admin_input,'admin','#admin_list', function() {
        let buttons = document.querySelectorAll('.admininput');
        let modal = document.querySelector('.modal');
        let cancel = document.querySelector('.buttons #cancel');

        buttons.forEach(button => {
            button.addEventListener("click", function() {
                modal.style.visibility = 'visible';
                let wordid = this.dataset.id;
                let eng = this.dataset.eng;
                let dai = this.dataset.dai;

                document.querySelector('.id-input').value = wordid;
                document.querySelector('.eng-input').value = eng;
                document.querySelector('.dai-input').value = dai;
                
                console.log(wordid);
            });
        });

        cancel.addEventListener("click", function() {
            modal.style.visibility = 'hidden';
            console.log('close!');
        });
    });
</script>
{% endblock %}
